{{/* Populates layouts/_default/baseof.html */}}

{{ define "main" }}
	{{ if eq "development" hugo.Environment }}
	{{ `<!-- Template: layouts/index.html -->` | safeHTML }}
	{{ end }}

	{{ $featured := partialCached "featured-content.html" . }}
	{{ $posts := where .Site.RegularPages "Section" "post" }}
	{{ $paginator := .Paginate ( $posts | complement $featured ) 5 }}

	{{ if eq .Paginator.PageNumber 1 }}
		{{ if ne $featured nil }}
			{{ range first 1 $featured }}
				{{ partial "featured-summary.html" . }}
			{{ end }}
		{{ end }}
	{{ end }}
	{{ partial "pagination.html" . }}
	{{ if eq .Paginator.PageNumber 1 }}
		{{ partial "upcoming.html" . }}
	{{ end }}
	{{ range $paginator.Pages }}
		{{ partial "summary.html" . }}
	{{ end }}
	{{ partial "pagination.html" . }}
{{ end }}
